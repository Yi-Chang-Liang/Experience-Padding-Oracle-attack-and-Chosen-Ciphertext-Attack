import requests

N = 20330970518755266242385905909493999137973424517956750150773387949450532738688140473016222471696353578971086244369854380559140307733766358995413733184270019263360966196480889892663449165581262567418515172910299228349764975639022173337717299671010360499385345258618681931950804787900352965945845764611738623330333991461000238591512750434491144339028770929223044620312099262465034253568878440783320799163740718510059832988003082752355931321805914693636091553425020056741155485595996089729505271434927528288363505735195072563272004104479612256661159085577310689018439362584786110537353301294577002586849490834964662377009
e = 176017195937730623562123747592078013189155197074053280649770136474672968778215745823517885186913756941022137245391137597807350100567017396357885051013778874401683908206146763549324783662154975115658507034180653906388362323548765829068065774694214943095348097082200118107056345501727632545607469759685883132593
C = 19803286414495981330870450369377715872676019761582054037317596577566473104382272273947388256197615394874292393112202628235903476124731068348505497099290573628894182977809740202619294758259872574785048616209131813280134942992152396562435381278031278003714089520128653354818296884091657183101776596985640911937527560903756271740659813806181439463783511199223171164610626514702610107528212587902037123680503490526074604074867706958117048387006821204720300245174495357190304469898279664415140040595254468149735767539024407285843623402381866131157763950114862821892112559155040447429428354098448851315373773712303264478559

lower_bound = 0
upper_bound = N
temp = 2
while lower_bound != upper_bound:
    ciphertext = str((pow(temp, e, N) * C) % N)
    destination = "http://xxx.xxx.xxx.xxx:8080/oracle/" + ciphertext
    oracle = requests.get(destination)
    #print(oracle.text)
    if oracle.text == "0":
        upper_bound = (lower_bound + upper_bound) // 2
    else:
        lower_bound = (lower_bound + upper_bound) // 2
    temp *= 2
    #print(temp)
print("=====================================================")
print("The decimal plaintest is:", lower_bound)
print("=====================================================")
low = hex(lower_bound)
print("The hexadecimal plaintest is:", low)
print("=====================================================")

a = str(low)
a1 = []
for i in range(2, len(a), 2):
    b = a[i : i + 2]
    a1.append(chr(int(b, 16)))
print("Final answer is:", ''.join(a1))
